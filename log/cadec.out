/home/bureaux/miniconda3/envs/w2ner/bin/python /home/bureaux/Projects/W2NER/train.py --config ./config/cadec.json
2023-04-21 10:31:41 - INFO: dict_items([('dataset', 'cadec'), ('save_path', 'weights/cadec.pt'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 512), ('conv_hid_size', 80), ('bert_hid_size', 768), ('biaffine_size', 512), ('ffnn_hid_size', 120), ('dilation', [1, 2, 3]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 16), ('learning_rate', 0.001), ('weight_decay', 0), ('clip_grad_norm', 5.0), ('bert_name', 'dmis-lab/biobert-base-cased-v1.2'), ('bert_learning_rate', 5e-06), ('warm_factor', 0), ('early_stop_patience', 3), ('use_bert_last_4_layers', True), ('seed', 123), ('config', './config/cadec.json'), ('device', 0)])
2023-04-21 10:31:43 - INFO: Loading Data
Downloading: 100%|██████████| 1.11k/1.11k [00:00<00:00, 669kB/s]
Downloading: 100%|██████████| 213k/213k [00:00<00:00, 496kB/s]
2023-04-21 10:31:48 - INFO:
+-------+-----------+----------+
| cadec | sentences | entities |
+-------+-----------+----------+
| train |    5340   |   4428   |
|  dev  |    1097   |   898    |
|  test |    1160   |   990    |
+-------+-----------+----------+
2023-04-21 10:31:58 - INFO: Building Model
Downloading: 100%|██████████| 436M/436M [00:23<00:00, 18.8MB/s]
Some weights of the model checkpoint at dmis-lab/biobert-base-cased-v1.2 were not used when initializing BertModel: ['cls.predictions.decoder.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.bias', 'cls.seq_relationship.weight', 'cls.predictions.decoder.bias', 'cls.predictions.transform.dense.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/home/bureaux/miniconda3/envs/w2ner/lib/python3.8/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
2023-04-21 10:32:26 - INFO: ----------Epoch: 0----------
Training epoch 1: 100%|██████████| 333/333 [00:31<00:00, 10.70it/s]
2023-04-21 10:32:58 - INFO:
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0283 | 0.5068 |   0.6457  | 0.4585 |
+---------+--------+--------+-----------+--------+
Epoch 1 dev set: 100%|██████████| 69/69 [00:02<00:00, 28.85it/s]
2023-04-21 10:33:01 - INFO: VALID Label F1 [0.99830148 0.6655448  0.61335096]
2023-04-21 10:33:01 - INFO:
+---------+--------+-----------+--------+
| VALID 1 |   F1   | Precision | Recall |
+---------+--------+-----------+--------+
|  Label  | 0.7591 |   0.8254  | 0.7103 |
|  Entity | 0.6003 |   0.7832  | 0.4866 |
+---------+--------+-----------+--------+
Epoch 1 test set: 100%|██████████| 73/73 [00:02<00:00, 24.38it/s]
2023-04-21 10:33:04 - INFO: TEST Label F1 [0.99838116 0.65693431 0.60099751]
2023-04-21 10:33:04 - INFO:
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7521 |   0.8450  | 0.6896 |
| Entity | 0.5785 |   0.8147  | 0.4485 |
+--------+--------+-----------+--------+
2023-04-21 10:33:05 - INFO: Saved model to weights/cadec.pt.
2023-04-21 10:33:05 - INFO: ----------Epoch: 1----------
Training epoch 2: 100%|██████████| 333/333 [00:31<00:00, 10.66it/s]
2023-04-21 10:33:37 - INFO:
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0113 | 0.7321 |   0.8161  | 0.6764 |
+---------+--------+--------+-----------+--------+
Epoch 2 dev set: 100%|██████████| 69/69 [00:02<00:00, 30.07it/s]
2023-04-21 10:33:39 - INFO: VALID Label F1 [0.99833247 0.69724058 0.68249586]
2023-04-21 10:33:39 - INFO:
+---------+--------+-----------+--------+
| VALID 2 |   F1   | Precision | Recall |
+---------+--------+-----------+--------+
|  Label  | 0.7927 |   0.7906  | 0.7948 |
|  Entity | 0.6690 |   0.6874  | 0.6514 |
+---------+--------+-----------+--------+
Epoch 2 test set: 100%|██████████| 73/73 [00:02<00:00, 24.43it/s]
2023-04-21 10:33:42 - INFO: TEST Label F1 [0.99854545 0.71021454 0.7177665 ]
2023-04-21 10:33:42 - INFO:
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8088 |   0.8195  | 0.7989 |
| Entity | 0.6997 |   0.7399  | 0.6636 |
+--------+--------+-----------+--------+
2023-04-21 10:33:44 - INFO: Saved model to weights/cadec.pt.
2023-04-21 10:33:44 - INFO: ----------Epoch: 2----------
Training epoch 3: 100%|██████████| 333/333 [00:33<00:00, 10.04it/s]
2023-04-21 10:34:17 - INFO:
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0093 | 0.7866 |   0.8351  | 0.7476 |
+---------+--------+--------+-----------+--------+
Epoch 3 dev set: 100%|██████████| 69/69 [00:02<00:00, 31.15it/s]
2023-04-21 10:34:20 - INFO: VALID Label F1 [0.99851034 0.71140387 0.69502696]
2023-04-21 10:34:20 - INFO:
+---------+--------+-----------+--------+
| VALID 3 |   F1   | Precision | Recall |
+---------+--------+-----------+--------+
|  Label  | 0.8016 |   0.8352  | 0.7723 |
|  Entity | 0.6744 |   0.7486  | 0.6136 |
+---------+--------+-----------+--------+
Epoch 3 test set: 100%|██████████| 73/73 [00:03<00:00, 23.36it/s]
2023-04-21 10:34:23 - INFO: TEST Label F1 [0.9986215  0.70414993 0.72457394]
2023-04-21 10:34:23 - INFO:
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8091 |   0.8543  | 0.7712 |
| Entity | 0.6944 |   0.7823  | 0.6242 |
+--------+--------+-----------+--------+
2023-04-21 10:34:25 - INFO: Saved model to weights/cadec.pt.
2023-04-21 10:34:25 - INFO: ----------Epoch: 3----------
Training epoch 4: 100%|██████████| 333/333 [00:32<00:00, 10.33it/s]
2023-04-21 10:34:58 - INFO:
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0084 | 0.8109 |   0.8436  | 0.7828 |
+---------+--------+--------+-----------+--------+
Epoch 4 dev set: 100%|██████████| 69/69 [00:02<00:00, 28.47it/s]
2023-04-21 10:35:00 - INFO: VALID Label F1 [0.9982738  0.71497585 0.69069392]
2023-04-21 10:35:00 - INFO:
+---------+--------+-----------+--------+
| VALID 4 |   F1   | Precision | Recall |
+---------+--------+-----------+--------+
|  Label  | 0.8013 |   0.7696  | 0.8396 |
|  Entity | 0.6839 |   0.6909  | 0.6771 |
+---------+--------+-----------+--------+
Epoch 4 test set: 100%|██████████| 73/73 [00:03<00:00, 24.16it/s]
2023-04-21 10:35:03 - INFO: TEST Label F1 [0.99848987 0.7246941  0.74190383]
2023-04-21 10:35:03 - INFO:
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8217 |   0.7933  | 0.8551 |
| Entity | 0.7253 |   0.7390  | 0.7121 |
+--------+--------+-----------+--------+
2023-04-21 10:35:05 - INFO: Saved model to weights/cadec.pt.
2023-04-21 10:35:05 - INFO: ----------Epoch: 4----------
Training epoch 5: 100%|██████████| 333/333 [00:34<00:00,  9.59it/s]
2023-04-21 10:35:40 - INFO:
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0072 | 0.8341 |   0.8581  | 0.8132 |
+---------+--------+--------+-----------+--------+
Epoch 5 dev set: 100%|██████████| 69/69 [00:02<00:00, 27.09it/s]
2023-04-21 10:35:43 - INFO: VALID Label F1 [0.99835036 0.72207982 0.70133883]
2023-04-21 10:35:43 - INFO:
+---------+--------+-----------+--------+
| VALID 5 |   F1   | Precision | Recall |
+---------+--------+-----------+--------+
|  Label  | 0.8073 |   0.7777  | 0.8412 |
|  Entity | 0.6918 |   0.6781  | 0.7060 |
+---------+--------+-----------+--------+
Epoch 5 test set: 100%|██████████| 73/73 [00:03<00:00, 22.37it/s]
2023-04-21 10:35:46 - INFO: TEST Label F1 [0.99855184 0.72964169 0.74420804]
2023-04-21 10:35:46 - INFO:
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8241 |   0.8000  | 0.8510 |
| Entity | 0.7225 |   0.7129  | 0.7323 |
+--------+--------+-----------+--------+
2023-04-21 10:35:48 - INFO: Saved model to weights/cadec.pt.
2023-04-21 10:35:48 - INFO: ----------Epoch: 5----------
Training epoch 6: 100%|██████████| 333/333 [00:35<00:00,  9.41it/s]
2023-04-21 10:36:24 - INFO:
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0064 | 0.8568 |   0.8712  | 0.8436 |
+---------+--------+--------+-----------+--------+
Epoch 6 dev set: 100%|██████████| 69/69 [00:02<00:00, 28.63it/s]
2023-04-21 10:36:26 - INFO: VALID Label F1 [0.99849015 0.72842942 0.70600975]
2023-04-21 10:36:26 - INFO:
+---------+--------+-----------+--------+
| VALID 6 |   F1   | Precision | Recall |
+---------+--------+-----------+--------+
|  Label  | 0.8110 |   0.8102  | 0.8125 |
|  Entity | 0.6949 |   0.7136  | 0.6771 |
+---------+--------+-----------+--------+
Epoch 6 test set: 100%|██████████| 73/73 [00:03<00:00, 21.99it/s]
2023-04-21 10:36:30 - INFO: TEST Label F1 [0.99866885 0.7314578  0.75187219]
2023-04-21 10:36:30 - INFO:
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8273 |   0.8338  | 0.8217 |
| Entity | 0.7361 |   0.7675  | 0.7071 |
+--------+--------+-----------+--------+
2023-04-21 10:36:31 - INFO: Saved model to weights/cadec.pt.
2023-04-21 10:36:31 - INFO: ----------Epoch: 6----------
Training epoch 7: 100%|██████████| 333/333 [00:36<00:00,  9.22it/s]
2023-04-21 10:37:08 - INFO:
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0057 | 0.8708 |   0.8823  | 0.8601 |
+---------+--------+--------+-----------+--------+
Epoch 7 dev set: 100%|██████████| 69/69 [00:02<00:00, 29.12it/s]
2023-04-21 10:37:11 - INFO: VALID Label F1 [0.99852708 0.73256277 0.71819646]
2023-04-21 10:37:11 - INFO:
+---------+--------+-----------+--------+
| VALID 7 |   F1   | Precision | Recall |
+---------+--------+-----------+--------+
|  Label  | 0.8164 |   0.8143  | 0.8196 |
|  Entity | 0.7032 |   0.7141  | 0.6927 |
+---------+--------+-----------+--------+
Epoch 7 test set: 100%|██████████| 73/73 [00:02<00:00, 26.05it/s]
2023-04-21 10:37:14 - INFO: TEST Label F1 [0.99860504 0.71816151 0.74854369]
2023-04-21 10:37:14 - INFO:
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8218 |   0.8212  | 0.8238 |
| Entity | 0.7237 |   0.7347  | 0.7131 |
+--------+--------+-----------+--------+
2023-04-21 10:37:15 - INFO: Saved model to weights/cadec.pt.
2023-04-21 10:37:15 - INFO: ----------Epoch: 7----------
Training epoch 8: 100%|██████████| 333/333 [00:37<00:00,  8.97it/s]
2023-04-21 10:37:53 - INFO:
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0053 | 0.8822 |   0.8884  | 0.8762 |
+---------+--------+--------+-----------+--------+
Epoch 8 dev set: 100%|██████████| 69/69 [00:02<00:00, 23.45it/s]
2023-04-21 10:37:56 - INFO: VALID Label F1 [0.99844799 0.72644377 0.7130712 ]
2023-04-21 10:37:56 - INFO:
+---------+--------+-----------+--------+
| VALID 8 |   F1   | Precision | Recall |
+---------+--------+-----------+--------+
|  Label  | 0.8127 |   0.7968  | 0.8298 |
|  Entity | 0.7005 |   0.7017  | 0.6993 |
+---------+--------+-----------+--------+
Epoch 8 test set: 100%|██████████| 73/73 [00:03<00:00, 20.60it/s]
2023-04-21 10:38:00 - INFO: TEST Label F1 [0.99858588 0.72424242 0.75290698]
2023-04-21 10:38:00 - INFO:
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8252 |   0.8114  | 0.8401 |
| Entity | 0.7318 |   0.7333  | 0.7303 |
+--------+--------+-----------+--------+
2023-04-21 10:38:00 - INFO: Epoch did not improve: 1/3.
2023-04-21 10:38:00 - INFO: ----------Epoch: 8----------
Training epoch 9: 100%|██████████| 333/333 [00:35<00:00,  9.40it/s]
2023-04-21 10:38:36 - INFO:
+---------+--------+--------+-----------+--------+
| Train 9 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0049 | 0.8898 |   0.8974  | 0.8826 |
+---------+--------+--------+-----------+--------+
Epoch 9 dev set: 100%|██████████| 69/69 [00:02<00:00, 24.59it/s]
2023-04-21 10:38:39 - INFO: VALID Label F1 [0.99852838 0.72894212 0.71772429]
2023-04-21 10:38:39 - INFO:
+---------+--------+-----------+--------+
| VALID 9 |   F1   | Precision | Recall |
+---------+--------+-----------+--------+
|  Label  | 0.8151 |   0.8175  | 0.8132 |
|  Entity | 0.7041 |   0.7244  | 0.6849 |
+---------+--------+-----------+--------+
Epoch 9 test set: 100%|██████████| 73/73 [00:03<00:00, 23.95it/s]
2023-04-21 10:38:42 - INFO: TEST Label F1 [0.99860213 0.71355499 0.74726368]
2023-04-21 10:38:42 - INFO:
+--------+--------+-----------+--------+
| TEST 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8198 |   0.8252  | 0.8152 |
| Entity | 0.7202 |   0.7438  | 0.6980 |
+--------+--------+-----------+--------+
2023-04-21 10:38:44 - INFO: Saved model to weights/cadec.pt.
2023-04-21 10:38:44 - INFO: ----------Epoch: 9----------
Training epoch 10: 100%|██████████| 333/333 [00:36<00:00,  9.20it/s]
2023-04-21 10:39:20 - INFO:
+----------+--------+--------+-----------+--------+
| Train 10 |  Loss  |   F1   | Precision | Recall |
+----------+--------+--------+-----------+--------+
|  Label   | 0.0045 | 0.8971 |   0.9039  | 0.8906 |
+----------+--------+--------+-----------+--------+
Epoch 10 dev set: 100%|██████████| 69/69 [00:02<00:00, 26.27it/s]
2023-04-21 10:39:23 - INFO: VALID Label F1 [0.99849868 0.72904483 0.71645022]
2023-04-21 10:39:23 - INFO:
+----------+--------+-----------+--------+
| VALID 10 |   F1   | Precision | Recall |
+----------+--------+-----------+--------+
|  Label   | 0.8147 |   0.8087  | 0.8211 |
|  Entity  | 0.7010 |   0.7118  | 0.6904 |
+----------+--------+-----------+--------+
Epoch 10 test set: 100%|██████████| 73/73 [00:03<00:00, 22.40it/s]
2023-04-21 10:39:27 - INFO: TEST Label F1 [0.99859701 0.71825273 0.75098425]
2023-04-21 10:39:27 - INFO:
+---------+--------+-----------+--------+
| TEST 10 |   F1   | Precision | Recall |
+---------+--------+-----------+--------+
|  Label  | 0.8226 |   0.8192  | 0.8264 |
|  Entity | 0.7278 |   0.7388  | 0.7172 |
+---------+--------+-----------+--------+
2023-04-21 10:39:27 - INFO: Epoch did not improve: 1/3.
2023-04-21 10:39:27 - INFO: Best DEV F1: 0.7041
2023-04-21 10:39:27 - INFO: Best TEST F1: 0.7202
Epoch Final test set: 100%|██████████| 73/73 [00:02<00:00, 24.92it/s]
2023-04-21 10:39:30 - INFO: TEST Label F1 [0.99860213 0.71355499 0.74726368]
2023-04-21 10:39:30 - INFO:
+------------+--------+-----------+--------+
| TEST Final |   F1   | Precision | Recall |
+------------+--------+-----------+--------+
|   Label    | 0.8198 |   0.8252  | 0.8152 |
|   Entity   | 0.7202 |   0.7438  | 0.6980 |
+------------+--------+-----------+--------+

进程已结束,退出代码0

[{
    "text": ["I", "am", "having", "horrible", "aching", "in", "my", "fingers", ",", "knees", ",", "hips", "&", "toes", "."],
    "entities": [
        [
            ["aching", "in", "my", "toes"], "adr", [4, 5, 6, 13]
        ],
        [
            ["aching", "in", "knees"], "adr", [4, 5, 9]
        ],
        [
            ["aching", "in", "my", "hips"], "adr", [4, 5, 6, 11]
        ],
        [
            ["aching", "in", "my", "knees"], "adr", [4, 5, 6, 9]
        ],
        [
            ["aching", "in", "hips"], "adr", [4, 5, 11]
        ],
        [
            ["aching", "in", "my", "fingers"], "adr", [4, 5, 6, 7]
        ],
        [
            ["aching", "in", "toes"], "adr", [4, 5, 13]
        ]
    ]
}, {
    "text": ["Muscle", "Pain", "in", "left", "arm", "and", "upper", "back", "."],
    "entities": [
        [
            ["Muscle", "Pain", "in", "upper", "back"], "adr", [0, 1, 2, 6, 7]
        ],
        [
            ["Muscle", "Pain", "in", "left", "arm"], "adr", [0, 1, 2, 3, 4]
        ]
    ]
}]
